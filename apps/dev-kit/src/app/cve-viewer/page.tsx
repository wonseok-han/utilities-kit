import { PageWrapper } from '@components';
import { fetchRecentCVEs } from '@services/cve';

import { CVEViewerClient, CVEViewerHeader } from './components';

/**
 * CVE Viewer 페이지 - 서버사이드 렌더링
 *
 * 서버에서 정적 콘텐츠를 렌더링하고,
 * 동적 데이터는 클라이언트 컴포넌트에서 처리합니다.
 *
 * 이 페이지는 서버에서 초기 데이터를 가져와 클라이언트 컴포넌트에 전달하여
 * SEO 최적화와 초기 로딩 성능을 모두 확보합니다.
 */
export default async function CVEViewerPage() {
  // ===== 서버에서 초기 데이터 페칭 =====
  const result = await fetchRecentCVEs(1, 50).catch(() => ({
    cves: [],
    pagination: { hasMore: true },
  }));
  const initialCVEs = result.cves;
  const metadata = result.pagination;

  return (
    <PageWrapper>
      {/* ===== 서버에서 렌더링되는 정적 콘텐츠 ===== */}
      <CVEViewerHeader />

      {/* ===== 클라이언트에서 처리되는 동적 콘텐츠 ===== */}
      <CVEViewerClient initialCVEs={initialCVEs} metadata={metadata} />
    </PageWrapper>
  );
}
